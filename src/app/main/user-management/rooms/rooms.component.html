<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JAOM Admin - User Management / Rooms</title>
  </head>
  <body>
    <div class="wrapper">
      <app-left-bar style="z-index: 1000;"></app-left-bar>

      <div class="content">
        <app-top-bar id="top-bar"></app-top-bar>
        <div class="content-container">
          <p>Rooms</p>
          <div>
            <div class="d-flex justify-content-end" style="margin: 20px">
              <div class="input-group" style="width: 20%">
                <input
                  type="text"
                  [(ngModel)]="searchTerm"
                  (input)="applySearchFilter(0)"
                  placeholder="Search by ID, Sender ID, Receiver ID, Data, ...."
                  class="form-control filter-user-search"
                />
                <div class="input-group-append">
                  <span class="input-group-text">
                    <i class="fa fa-search"></i>
                  </span>
                </div>
              </div>
            </div>
            <div class="table-responsive">
              <table class="table table-bordered users-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Group Icon</th>
                    <th>Name</th>
                    <th>Owner</th>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let data of filteredRooms">
                    <td>{{ data?.id }}</td>
                    <td>
                      <img
                        style="width: 40px; height: 40px; border-radius: 50%"
                        [src]="data?.group_image"
                      />
                    </td>
                    <td>{{ data?.name }}</td>
                    <td>
                      {{ data?.user?.firstname }} {{ data?.user?.lastname }}
                    </td>
                    <td>{{ data?.created_at | date : "MMMM d, y" }}</td>
                    <td>{{ data?.created_at | date : "h:mm a" }}</td>
                    <td class="action-cont">
                      <img
                        (click)="deleteSpecificRoom(data?.id)"
                        [src]="imageUrls.delete"
                        alt=""
                      />
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="pagination-cont">
              <ul class="pagination">
                <li class="page-item" [class.disabled]="currentPage === 1">
                  <a class="page-link" (click)="onPageChange(1, 0)"><<</a>
                </li>
                <li class="page-item" [class.disabled]="currentPage === 1">
                  <a
                    class="page-link"
                    (click)="onPageChange(currentPage - 1, 0)"
                    >Previous</a
                  >
                </li>
                <li
                  class="page-item"
                  *ngFor="let page of getPageRange(0)"
                  [class.active]="currentPage === page"
                >
                  <a class="page-link" (click)="onPageChange(page, 0)">{{
                    page
                  }}</a>
                </li>
                <li
                  class="page-item"
                  [class.disabled]="currentPage === roomListData?.last_page"
                >
                  <a
                    class="page-link"
                    (click)="onPageChange(currentPage + 1, 0)"
                    >Next</a
                  >
                </li>
                <li
                  class="page-item"
                  [class.disabled]="currentPage === roomListData?.last_page"
                >
                  <a
                    class="page-link"
                    (click)="onPageChange(roomListData?.last_page, 0)"
                    >>></a
                  >
                </li>
              </ul>
              <p class="text-muted showing-pagination">
                Showing {{ getStartingIndex(0) }} -
                {{ getCurrentPageEnd(0) }} of {{ roomListData?.total }} rooms
              </p>
            </div>
          </div>

          <div>
            <div class="d-flex justify-content-end" style="margin: 20px">
              <div class="input-group" style="width: 20%">
                <input
                  type="text"
                  [(ngModel)]="searchTerm2"
                  (input)="applySearchFilter(1)"
                  placeholder="Search by ID, Sender ID, Receiver ID, Data, ...."
                  class="form-control filter-user-search"
                />
                <div class="input-group-append">
                  <span class="input-group-text">
                    <i class="fa fa-search"></i>
                  </span>
                </div>
              </div>
            </div>
            <div class="table-responsive">
              <table class="table table-bordered users-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Sender ID</th>
                    <th>Sender Name</th>
                    <th>Room ID</th>
                    <th>Chat</th>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let data of filteredRoomChats">
                    <td>{{ data?.id }}</td>
                    <td>{{ data?.user_id }}</td>
                    <td>{{ data?.sender_name }}</td>
                    <td>{{ data?.group_id }}</td>
                    <td>{{ data?.content }}</td>
                    <td>{{ data?.created_at | date : "MMMM d, y" }}</td>
                    <td>{{ data?.created_at | date : "h:mm a" }}</td>
                    <td class="action-cont">
                      <img
                        (click)="deleteSpecificRoomChat(data?.id)"
                        [src]="imageUrls.delete"
                        alt=""
                      />
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="pagination-cont">
              <ul class="pagination">
                <li class="page-item" [class.disabled]="currentPage2 === 1">
                  <a class="page-link" (click)="onPageChange(1, 1)"><<</a>
                </li>
                <li class="page-item" [class.disabled]="currentPage2 === 1">
                  <a
                    class="page-link"
                    (click)="onPageChange(currentPage2 - 1, 1)"
                    >Previous</a
                  >
                </li>
                <li
                  class="page-item"
                  *ngFor="let page of getPageRange(1)"
                  [class.active]="currentPage2 === page"
                >
                  <a class="page-link" (click)="onPageChange(page, 1)">{{
                    page
                  }}</a>
                </li>
                <li
                  class="page-item"
                  [class.disabled]="
                    currentPage2 === roomChatListData?.data?.last_page
                  "
                >
                  <a
                    class="page-link"
                    (click)="onPageChange(currentPage2 + 1, 1)"
                    >Next</a
                  >
                </li>
                <li
                  class="page-item"
                  [class.disabled]="
                    currentPage2 === roomChatListData?.data?.last_page
                  "
                >
                  <a
                    class="page-link"
                    (click)="onPageChange(roomChatListData?.data?.last_page, 1)"
                    >>></a
                  >
                </li>
              </ul>
              <p class="text-muted showing-pagination">
                Showing {{ getStartingIndex(1) }} -
                {{ getCurrentPageEnd(1) }} of
                {{ roomChatListData?.data?.total }} group-chats
              </p>
            </div>
          </div>
          <div class="dialog-messages delete-dialog-message">
            <p class="text-danger">Room deleted successfully</p>
          </div>
        </div>
      </div>
    </div>
    <app-spinner-loading *ngIf="isSpinnerLoading"></app-spinner-loading>
  </body>
</html>
